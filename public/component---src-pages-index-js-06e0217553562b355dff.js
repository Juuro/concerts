"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[293],{274:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var n=a(6540),l=a(8595),r=a(2326),s=a(2269),c=a(4794);var o=e=>{let{data:t,max:a,title:l,category:r}=e;const s=(e,t)=>{if(t>=0){return Math.round(100*e/t)}};return n.createElement("div",{className:"barchart"},n.createElement("h4",{title:l},r),n.createElement("ul",null,null==t?void 0:t.map((e=>n.createElement("li",{key:e[0],title:e[0]},n.createElement("span",{className:"bar",style:{width:s(e[1],a)+"%"}},"Â "),n.createElement("span",{className:"text"},(e=>e[2]?n.createElement(c.Link,{to:`/${r}/${e[2]}`},n.createElement("strong",null,e[1])," ",e[0]):n.createElement(n.Fragment,null,n.createElement("strong",null,e[1])," ",e[0]))(e)))))))};var i=()=>{const{0:e,1:t}=(0,n.useState)({}),{0:a,1:l}=(0,n.useState)({}),{0:r,1:s}=(0,n.useState)(0),{0:i,1:d}=(0,n.useState)(0),{0:m,1:u}=(0,n.useState)([]),{0:f,1:g}=(0,n.useState)(0),E=Object.entries(e),v=Object.entries(a),{allContentfulConcert:{nodes:b},allContentfulBand:{edges:y}}=(0,c.useStaticQuery)("1653953001");return(0,n.useEffect)((()=>{const e=y.filter((e=>!!e.node.concert)).map((e=>{const t=e.node.concert.filter((e=>new Date>new Date(e.date))).length;return{id:e.node.id,slug:e.node.slug,name:e.node.name,numberOfConcerts:t}})).sort(((e,t)=>t.numberOfConcerts-e.numberOfConcerts)).slice(0,5);u(e)}),[y]),(0,n.useEffect)((()=>{g(Math.max.apply(null,m.map((e=>e.numberOfConcerts))))}),[m]),(0,n.useEffect)((()=>{const e=b.map((e=>!(new Date<new Date(e.date))&&e.fields.geocoderAddressFields._normalized_city)).filter((e=>!1!==e&&null!==e));if(0===Object.entries(a).length){const t={};for(const a of e)a&&(t[a]=t[a]?t[a]+1:1);l(t)}}),[b,a]),(0,n.useEffect)((()=>{const a=b.filter((e=>!(new Date<new Date(e.date)))).map((e=>e.year)).filter((e=>!1!==e)).flat();if(0===Object.entries(e).length){const e={};for(const t of a)e[t]=e[t]?e[t]+1:1;t(e)}}),[b,e]),(0,n.useEffect)((()=>{s(Math.max.apply(null,Object.values(e)))}),[e]),(0,n.useEffect)((()=>{d(Math.max.apply(null,Object.values(a)))}),[a]),n.createElement(n.StrictMode,null,n.createElement("div",{className:"card statistics-widget"},n.createElement(o,{data:E.sort(((e,t)=>t[1]-e[1])).slice(0,5).map((e=>[e[0],e[1],e[0]])),max:r,title:"most concerts per year",category:"year"}),n.createElement(o,{data:m.map((e=>[e.name,e.numberOfConcerts,e.slug])),max:f,title:"most concerts per band",category:"band"}),n.createElement(o,{data:v.sort(((e,t)=>t[1]-e[1])).slice(0,5).map((e=>{var t;return[e[0],e[1],null===(t=e[0])||void 0===t?void 0:t.toLowerCase().replace("/s+/","-")]})),max:i,title:"most concerts per city",category:"city"})))};var d=e=>{let{data:t}=e;const a=t.site.siteMetadata.title,c=t.allContentfulConcert;return n.createElement(l.A,null,n.createElement("main",null,n.createElement("div",{className:"container"},n.createElement(s.A,{title:a}),n.createElement(i,null),n.createElement("ul",{className:"list-unstyled"},c.edges.map((e=>{let{node:t}=e;return n.createElement(r.A,{key:t.id,concert:t})}))))))}},2326:function(e,t,a){var n=a(4506),l=a(6540),r=a(4794);t.A=e=>{var t;let{concert:a}=e;const s=()=>{const e=(0,n.A)(a.bands);return a.isFestival||e.shift(),e.map((e=>l.createElement(r.Link,{to:`/band/${e.slug}`,key:e.id,className:"badge bg-primary mr-2"},e.name)))},c=()=>{var e,t,n,l,r,s;console.log("Band:",a.bands[0].name),console.log("Last.fm data:",null===(e=a.bands[0].fields)||void 0===e?void 0:e.lastfm),console.log("Last.fm images:",null===(t=a.bands[0].fields)||void 0===t||null===(n=t.lastfm)||void 0===n?void 0:n.images);const c=null===(l=a.bands[0].fields)||void 0===l||null===(r=l.lastfm)||void 0===r?void 0:r.images,o=(null==c?void 0:c.extralarge)||(null==c?void 0:c.large)||(null==c?void 0:c.medium);if(o&&""!==o.trim())return console.log("Using Last.fm image:",o),o;const i=null===(s=a.bands[0].image)||void 0===s?void 0:s.file.url;return console.log("Using Contentful image:",i),i};return l.createElement("li",{className:"concert-card card "+(a.date>(new Date).toISOString()?"future":"")},l.createElement("div",{className:"concert-card-image",style:{backgroundImage:c()?`url(${c()})`:"none"}}),l.createElement("div",{className:"concert-card-body"},l.createElement("h3",{className:"card-title"},a.isFestival?a.festival.name:l.createElement(r.Link,{to:`/band/${a.bands[0].slug}`},a.bands[0].name)),l.createElement("span",null,new Date(a.date).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})),s()&&l.createElement("div",{className:"bands"},s())),l.createElement("div",{className:"concert-card-location"},l.createElement("div",null,l.createElement("div",{className:"club"},a.club),l.createElement("div",{className:"city"},l.createElement(r.Link,{to:`/city/${null===(t=a.fields.geocoderAddressFields._normalized_city)||void 0===t?void 0:t.toLowerCase()}`},a.fields.geocoderAddressFields._normalized_city)))))}}}]);
//# sourceMappingURL=component---src-pages-index-js-06e0217553562b355dff.js.map