{"version":3,"file":"component---src-pages-index-js-fc529cfe458b981da634.js","mappings":"uOAkDA,MA7CiBA,IAAqC,IAApC,KAAEC,EAAI,IAAEC,EAAG,MAAEC,EAAK,SAAEC,GAAUJ,EAC9C,MAAMK,EAAiBA,CAACC,EAAUC,KAChC,GAAIA,GAAS,EAAG,CAEd,OADmBC,KAAKC,MAAkB,IAAXH,EAAkBC,EAEnD,GAkBF,OACEG,EAAAA,cAAA,OAAKC,UAAU,YACbD,EAAAA,cAAA,MAAIP,MAAOA,GAAQC,GACnBM,EAAAA,cAAA,UACGT,aAAI,EAAJA,EAAMW,KAAKC,GAERH,EAAAA,cAAA,MAAII,IAAKD,EAAQ,GAAIV,MAAOU,EAAQ,IAClCH,EAAAA,cAAA,QACEC,UAAU,MACVI,MAAO,CAAEC,MAAOX,EAAeQ,EAAQ,GAAIX,GAAO,MACnD,KAGDQ,EAAAA,cAAA,QAAMC,UAAU,QA5BRE,IACdA,EAAQ,GAERH,EAAAA,cAACO,EAAAA,KAAI,CAACC,GAAI,IAAId,KAAYS,EAAQ,MAChCH,EAAAA,cAAA,cAASG,EAAQ,IAAY,IAAEA,EAAQ,IAK3CH,EAAAA,cAAAA,EAAAA,SAAA,KACEA,EAAAA,cAAA,cAASG,EAAQ,IAAY,IAAEA,EAAQ,IAkBTM,CAAWN,QAKvC,ECsIV,MA9KyBO,KACvB,MAAM,EAACC,EAAiB,EAACC,IAAuBC,EAAAA,EAAAA,UAAS,CAAC,IACpD,EAACC,EAAiB,EAACC,IAAuBF,EAAAA,EAAAA,UAAS,CAAC,IACpD,EAACG,EAAa,EAACC,IAAmBJ,EAAAA,EAAAA,UAAS,IAC3C,EAACK,EAAW,EAACC,IAAiBN,EAAAA,EAAAA,UAAS,IACvC,EAACO,EAAmB,EAACC,IAAyBR,EAAAA,EAAAA,UAAS,KACvD,EAACS,EAAsB,EAACC,IAA4BV,EAAAA,EAAAA,UAAS,GAE7DW,EAAmBC,OAAOC,QAAQf,GAClCgB,EAAmBF,OAAOC,QAAQZ,IAGtCc,sBAAwBC,MAAOC,GAC/BC,mBAAqBC,MAAOC,KAC1BC,EAAAA,EAAAA,gBAAe,cAwHnB,OAvFAC,EAAAA,EAAAA,YAAU,KACR,MAAMC,EAAaH,EAChBI,QAAQC,KAAWA,EAAKC,KAAKC,UAC7BtC,KAAKoC,IACJ,MAAMG,EAAeH,EAAKC,KAAKC,QAAQH,QACpCG,GAAY,IAAIE,KAAS,IAAIA,KAAKF,EAAQG,QAC3CC,OAEF,MAAO,CACLC,GAAIP,EAAKC,KAAKM,GACdC,KAAMR,EAAKC,KAAKO,KAChBC,KAAMT,EAAKC,KAAKQ,KAChBC,iBAAkBP,EACnB,IAEFQ,MAAK,CAACC,EAAGC,IAAMA,EAAEH,iBAAmBE,EAAEF,mBACtCI,MAAM,EAAG,GACZ/B,EAAsBe,EAAW,GAChC,CAACH,KAEJE,EAAAA,EAAAA,YAAU,KACRZ,EACEzB,KAAKN,IAAI6D,MACP,KACAjC,EAAmBlB,KAAKoD,GAASA,EAAKN,oBAEzC,GACA,CAAC5B,KAEJe,EAAAA,EAAAA,YAAU,KACR,MAAMoB,EAAYzB,EACf5B,KAAKyC,IACJ,GAAI,IAAID,KAAS,IAAIA,KAAKC,EAAKA,MAC7B,OAAO,EAET,QAAQ,GACN,MAAOA,EAAKa,OAAOC,sBAAsBC,QACvC,OAAOf,EAAKa,OAAOC,sBAAsBC,QAC3C,MAAOf,EAAKa,OAAOC,sBAAsBE,KACvC,OAAOhB,EAAKa,OAAOC,sBAAsBE,KAC3C,MAAOhB,EAAKa,OAAOC,sBAAsBG,KACzC,QACE,OAAOjB,EAAKa,OAAOC,sBAAsBG,KAC7C,IAEDvB,QAAQuB,IAAkB,IAATA,IAEpB,GAAgD,IAA5CnC,OAAOC,QAAQZ,GAAkB8B,OAAc,CACjD,MAAMiB,EAAa,CAAC,EACpB,IAAK,MAAMD,KAAQL,EACjBM,EAAWD,GAAQC,EAAWD,GAAQC,EAAWD,GAAQ,EAAI,EAE/D7C,EAAoB8C,EACtB,IACC,CAAC/B,EAAOhB,KAEXqB,EAAAA,EAAAA,YAAU,KACR,MAAM2B,EAAYhC,EACfO,QAAQ0B,KACH,IAAIrB,KAAS,IAAIA,KAAKqB,EAAKpB,SAKhCzC,KAAK6D,GACGA,EAAKC,OAEb3B,QAAQ2B,IAAkB,IAATA,IACjBC,OAEH,GAAgD,IAA5CxC,OAAOC,QAAQf,GAAkBiC,OAAc,CACjD,MAAMsB,EAAa,CAAC,EACpB,IAAK,MAAMF,KAAQF,EACjBI,EAAWF,GAAQE,EAAWF,GAAQE,EAAWF,GAAQ,EAAI,EAE/DpD,EAAoBsD,EACtB,IACC,CAACpC,EAAOnB,KAEXwB,EAAAA,EAAAA,YAAU,KACRlB,EAAgBnB,KAAKN,IAAI6D,MAAM,KAAM5B,OAAO0C,OAAOxD,IAAmB,GACrE,CAACA,KAEJwB,EAAAA,EAAAA,YAAU,KACRhB,EAAcrB,KAAKN,IAAI6D,MAAM,KAAM5B,OAAO0C,OAAOrD,IAAmB,GACnE,CAACA,IAGFd,EAAAA,cAACA,EAAAA,WAAgB,KACfA,EAAAA,cAAA,OAAKC,UAAU,0BACbD,EAAAA,cAACoE,EAAQ,CACP7E,KAAMiC,EACHyB,MAAK,CAACC,EAAGC,IAAMA,EAAE,GAAKD,EAAE,KACxBE,MAAM,EAAG,GACTlD,KAAK8D,GAAS,CAACA,EAAK,GAAIA,EAAK,GAAIA,EAAK,MACzCxE,IAAKwB,EACLvB,MAAM,yBACNC,SAAS,SAEXM,EAAAA,cAACoE,EAAQ,CACP7E,KAAM6B,EAAmBlB,KAAKoD,GAAS,CACrCA,EAAKP,KACLO,EAAKN,iBACLM,EAAKR,QAEPtD,IAAK8B,EACL7B,MAAM,yBACNC,SAAS,SAEXM,EAAAA,cAACoE,EAAQ,CACP7E,KAAMoC,EACHsB,MAAK,CAACC,EAAGC,IAAMA,EAAE,GAAKD,EAAE,KACxBE,MAAM,EAAG,GACTlD,KAAK0D,IAAI,IAAAS,EAAA,MAAK,CACbT,EAAK,GACLA,EAAK,GACE,QADAS,EACPT,EAAK,UAAE,IAAAS,OAAA,EAAPA,EAASC,cAAcC,QAAQ,OAAQ,KACxC,IACH/E,IAAK0B,EACLzB,MAAM,yBACNC,SAAS,UAGI,EC5IvB,MA3BkBJ,IAAe,IAAd,KAAEC,GAAMD,EACzB,MAAMkF,EAAYjF,EAAKkF,KAAKC,aAAajF,MACnCkF,EAAWpF,EAAKqC,qBAEtB,OACE5B,EAAAA,cAAC4E,EAAAA,EAAM,KACL5E,EAAAA,cAAA,YACEA,EAAAA,cAAA,OAAKC,UAAU,aACbD,EAAAA,cAAC6E,EAAAA,EAAG,CAACpF,MAAO+E,IACZxE,EAAAA,cAACU,EAAgB,MACjBV,EAAAA,cAAA,MAAIC,UAAU,iBACX0E,EAAS3C,MAAM9B,KAAI4E,IAAA,IAAC,KAAEvC,GAAMuC,EAAA,OAC3B9E,EAAAA,cAAC+E,EAAAA,EAAW,CAAC3E,IAAKmC,EAAKM,GAAIL,QAASD,GAAQ,OAK7C,C,yDCkFb,IAtGoBjD,IAAkB,IAAD0F,EAAA,IAAhB,QAAExC,GAASlD,EAC9B,MASM2C,EAAQA,KACZ,MAAMA,GAAKgD,EAAAA,EAAAA,GAAOzC,EAAQP,OAE1B,OAAIO,EAAQ0C,YAaVjD,EAAMkD,QAZClD,EAAM/B,KAAKoD,GAEdtD,EAAAA,cAACO,EAAAA,KAAI,CACHC,GAAI,SAAS8C,EAAKR,OAClB1C,IAAKkD,EAAKT,GACV5C,UAAU,yBAETqD,EAAKP,OAiBd,EA+BF,OACE/C,EAAAA,cAAA,MAAIC,UAAW,sBAhBXuC,EAAQG,MAAO,IAAID,MAAO0C,cACrB,SAEF,KAcLpF,EAAAA,cAAA,OACEC,UAAU,qBACVI,MAAO,CACLgF,gBAAiB,OAA6B,QAA7BL,EAAOxC,EAAQP,MAAM,GAAGqD,aAAK,IAAAN,OAAA,EAAtBA,EAAwBO,KAAKC,UAGzDxF,EAAAA,cAAA,OAAKC,UAAU,qBACbD,EAAAA,cAAA,MAAIC,UAAU,cA5EduC,EAAQ0C,WACH1C,EAAQiD,SAAS1C,KAGxB/C,EAAAA,cAACO,EAAAA,KAAI,CAACC,GAAI,SAASgC,EAAQP,MAAM,GAAGa,QAASN,EAAQP,MAAM,GAAGc,OAyE5D/C,EAAAA,cAAA,YAlBS,IAAI0C,KAAKF,EAAQG,MAClB+C,mBAAmB,QAAS,CACtC1B,KAAM,UACN2B,MAAO,OACPC,IAAK,aAeF3D,KAAWjC,EAAAA,cAAA,OAAKC,UAAU,SAASgC,MAEtCjC,EAAAA,cAAA,OAAKC,UAAU,yBACbD,EAAAA,cAAA,WACEA,EAAAA,cAAA,OAAKC,UAAU,QAAQuC,EAAQqD,MAC/B7F,EAAAA,cAAA,OAAKC,UAAU,QACbD,EAAAA,cAACO,EAAAA,KAAI,CACHC,GAAI,SAASgC,EAAQgB,OAAOC,sBAAsBqC,iBAAiBxB,iBAElE9B,EAAQgB,OAAOC,sBAAsBqC,qBAK3C,C","sources":["webpack://gatsby-starter-default/./src/components/BarChart/barchart.js","webpack://gatsby-starter-default/./src/components/StatisticsWidget/statisticsWidget.js","webpack://gatsby-starter-default/./src/pages/index.js","webpack://gatsby-starter-default/./src/components/ConcertCard/concertCard.js"],"sourcesContent":["import React from \"react\"\nimport { Link } from \"gatsby\"\n\nimport \"./barchart.scss\"\n\nconst BarChart = ({ data, max, title, category }) => {\n  const calcPercentage = (absolute, dings) => {\n    if (dings >= 0) {\n      const percentage = Math.round((absolute * 100) / dings)\n      return percentage\n    }\n  }\n\n  const createLink = (element) => {\n    if (element[2]) {\n      return (\n        <Link to={`/${category}/${element[2]}`}>\n          <strong>{element[1]}</strong> {element[0]}\n        </Link>\n      )\n    }\n    return (\n      <>\n        <strong>{element[1]}</strong> {element[0]}\n      </>\n    )\n  }\n\n  return (\n    <div className=\"barchart\">\n      <h4 title={title}>{category}</h4>\n      <ul>\n        {data?.map((element) => {\n          return (\n            <li key={element[0]} title={element[0]}>\n              <span\n                className=\"bar\"\n                style={{ width: calcPercentage(element[1], max) + \"%\" }}\n              >\n                &nbsp;\n              </span>\n              <span className=\"text\">{createLink(element)}</span>\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport default BarChart\n","import React, { useEffect, useState } from \"react\"\nimport { useStaticQuery, graphql } from \"gatsby\"\n\nimport \"./statisticsWidget.scss\"\nimport BarChart from \"../BarChart/barchart\"\n\nconst StatisticsWidget = () => {\n  const [yearCountsObject, setYearCountsObject] = useState({})\n  const [cityCountsObject, setCityCountsObject] = useState({})\n  const [mostConcerts, setMostConcerts] = useState(0)\n  const [mostCities, setMostCities] = useState(0)\n  const [mostSeenBandsArray, setMostSeenBandsArray] = useState([])\n  const [mostConcertsOfOneBand, setMostConcertsOfOneBand] = useState(0)\n\n  const yearCountEntries = Object.entries(yearCountsObject)\n  const cityCountEntries = Object.entries(cityCountsObject)\n\n  const {\n    allContentfulConcert: { nodes: dates },\n    allContentfulBand: { edges: bands },\n  } = useStaticQuery(\n    graphql`\n      query MyQuery {\n        allContentfulConcert {\n          nodes {\n            year: date(formatString: \"YYYY\")\n            date\n            fields {\n              geocoderAddressFields {\n                city\n                town\n                village\n              }\n            }\n          }\n        }\n        allContentfulBand {\n          edges {\n            node {\n              name\n              slug\n              id\n              concert {\n                id\n                date\n              }\n            }\n          }\n        }\n      }\n    `\n  )\n\n  useEffect(() => {\n    const bandsArray = bands\n      .filter((elem) => !!elem.node.concert)\n      .map((elem) => {\n        const concertCount = elem.node.concert.filter(\n          (concert) => new Date() > new Date(concert.date)\n        ).length\n\n        return {\n          id: elem.node.id,\n          slug: elem.node.slug,\n          name: elem.node.name,\n          numberOfConcerts: concertCount,\n        }\n      })\n      .sort((a, b) => b.numberOfConcerts - a.numberOfConcerts)\n      .slice(0, 5)\n    setMostSeenBandsArray(bandsArray)\n  }, [bands])\n\n  useEffect(() => {\n    setMostConcertsOfOneBand(\n      Math.max.apply(\n        null,\n        mostSeenBandsArray.map((band) => band.numberOfConcerts)\n      )\n    )\n  }, [mostSeenBandsArray])\n\n  useEffect(() => {\n    const cityArray = dates\n      .map((date) => {\n        if (new Date() < new Date(date.date)) {\n          return false\n        }\n        switch (true) {\n          case !!date.fields.geocoderAddressFields.village:\n            return date.fields.geocoderAddressFields.village\n          case !!date.fields.geocoderAddressFields.town:\n            return date.fields.geocoderAddressFields.town\n          case !!date.fields.geocoderAddressFields.city:\n          default:\n            return date.fields.geocoderAddressFields.city\n        }\n      })\n      .filter((city) => city !== false)\n\n    if (Object.entries(cityCountsObject).length === 0) {\n      const cityCounts = {}\n      for (const city of cityArray) {\n        cityCounts[city] = cityCounts[city] ? cityCounts[city] + 1 : 1\n      }\n      setCityCountsObject(cityCounts)\n    }\n  }, [dates, cityCountsObject])\n\n  useEffect(() => {\n    const yearArray = dates\n      .filter((item) => {\n        if (new Date() < new Date(item.date)) {\n          return false\n        }\n        return true\n      })\n      .map((item) => {\n        return item.year\n      })\n      .filter((year) => year !== false)\n      .flat()\n\n    if (Object.entries(yearCountsObject).length === 0) {\n      const yearCounts = {}\n      for (const year of yearArray) {\n        yearCounts[year] = yearCounts[year] ? yearCounts[year] + 1 : 1\n      }\n      setYearCountsObject(yearCounts)\n    }\n  }, [dates, yearCountsObject])\n\n  useEffect(() => {\n    setMostConcerts(Math.max.apply(null, Object.values(yearCountsObject)))\n  }, [yearCountsObject])\n\n  useEffect(() => {\n    setMostCities(Math.max.apply(null, Object.values(cityCountsObject)))\n  }, [cityCountsObject])\n\n  return (\n    <React.StrictMode>\n      <div className=\"card statistics-widget\">\n        <BarChart\n          data={yearCountEntries\n            .sort((a, b) => b[1] - a[1])\n            .slice(0, 5)\n            .map((year) => [year[0], year[1], year[0]])}\n          max={mostConcerts}\n          title=\"most concerts per year\"\n          category=\"year\"\n        />\n        <BarChart\n          data={mostSeenBandsArray.map((band) => [\n            band.name,\n            band.numberOfConcerts,\n            band.slug,\n          ])}\n          max={mostConcertsOfOneBand}\n          title=\"most concerts per band\"\n          category=\"band\"\n        />\n        <BarChart\n          data={cityCountEntries\n            .sort((a, b) => b[1] - a[1])\n            .slice(0, 5)\n            .map((city) => [\n              city[0],\n              city[1],\n              city[0]?.toLowerCase().replace(\"/s+/\", \"-\"),\n            ])}\n          max={mostCities}\n          title=\"most concerts per city\"\n          category=\"city\"\n        />\n      </div>\n    </React.StrictMode>\n  )\n}\n\nexport default StatisticsWidget\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { graphql } from \"gatsby\"\n\nimport Layout from \"../components/layout\"\nimport ConcertCard from \"../components/ConcertCard/concertCard\"\nimport Seo from \"../components/seo\"\nimport StatisticsWidget from \"../components/StatisticsWidget/statisticsWidget\"\n\nconst IndexPage = ({ data }) => {\n  const siteTitle = data.site.siteMetadata.title\n  const concerts = data.allContentfulConcert\n\n  return (\n    <Layout>\n      <main>\n        <div className=\"container\">\n          <Seo title={siteTitle} />\n          <StatisticsWidget />\n          <ul className=\"list-unstyled\">\n            {concerts.edges.map(({ node }) => (\n              <ConcertCard key={node.id} concert={node} />\n            ))}\n          </ul>\n        </div>\n      </main>\n    </Layout>\n  )\n}\n\nIndexPage.propTypes = {\n  data: PropTypes.shape({\n    allContentfulConcert: PropTypes.object.isRequired,\n  }).isRequired,\n}\n\nexport default IndexPage\n\nexport const pageQuery = graphql`\n  query ConcertsIndexQuery {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n    allContentfulConcert(sort: { date: DESC }) {\n      edges {\n        node {\n          ...ContentfulConcertFields\n        }\n      }\n      totalCount\n    }\n  }\n`\n","import PropTypes from \"prop-types\"\nimport React from \"react\"\nimport { Link } from \"gatsby\"\n\nimport \"./concertCard.scss\"\n\nconst ConcertCard = ({ concert }) => {\n  const heading = () => {\n    if (concert.isFestival) {\n      return concert.festival.name\n    }\n    return (\n      <Link to={`/band/${concert.bands[0].slug}`}>{concert.bands[0].name}</Link>\n    )\n  }\n\n  const bands = () => {\n    const bands = [...concert.bands]\n    // TODO: Badges as seperate (tag) component?\n    if (concert.isFestival) {\n      return bands.map((band) => {\n        return (\n          <Link\n            to={`/band/${band.slug}`}\n            key={band.id}\n            className=\"badge bg-primary mr-2\"\n          >\n            {band.name}\n          </Link>\n        )\n      })\n    } else {\n      bands.shift()\n      return bands.map((band) => {\n        return (\n          <Link\n            to={`/band/${band.slug}`}\n            key={band.id}\n            className=\"badge bg-primary mr-2\"\n          >\n            {band.name}\n          </Link>\n        )\n      })\n    }\n  }\n\n  const cityTownVillage = () => {\n    switch (true) {\n      case !!concert.fields.geocoderAddressFields.village:\n        return concert.fields.geocoderAddressFields.village\n      case !!concert.fields.geocoderAddressFields.town:\n        return concert.fields.geocoderAddressFields.town\n      case !!concert.fields.geocoderAddressFields.city:\n      default:\n        return concert.fields.geocoderAddressFields.city\n    }\n  }\n\n  const isInTheFuture = () => {\n    if (concert.date > new Date().toISOString()) {\n      return \"future\"\n    }\n    return \"\"\n  }\n\n  const getDate = () => {\n    const date = new Date(concert.date)\n    return date.toLocaleDateString(\"de-DE\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    })\n  }\n\n  return (\n    <li className={`concert-card card ${isInTheFuture()}`}>\n      <div\n        className=\"concert-card-image\"\n        style={{\n          backgroundImage: `url(${concert.bands[0].image?.file.url})`,\n        }}\n      ></div>\n      <div className=\"concert-card-body\">\n        <h3 className=\"card-title\">{heading()}</h3>\n        <span>{getDate()}</span>\n        {bands() && <div className=\"bands\">{bands()}</div>}\n      </div>\n      <div className=\"concert-card-location\">\n        <div>\n          <div className=\"club\">{concert.club}</div>\n          <div className=\"city\">\n            <Link\n              to={`/city/${concert.fields.geocoderAddressFields._normalized_city.toLowerCase()}`}\n            >\n              {concert.fields.geocoderAddressFields._normalized_city}\n            </Link>\n          </div>\n        </div>\n      </div>\n    </li>\n  )\n}\n\nConcertCard.propTypes = {\n  concert: PropTypes.object,\n}\n\nexport default ConcertCard\n"],"names":["_ref","data","max","title","category","calcPercentage","absolute","dings","Math","round","React","className","map","element","key","style","width","Link","to","createLink","StatisticsWidget","yearCountsObject","setYearCountsObject","useState","cityCountsObject","setCityCountsObject","mostConcerts","setMostConcerts","mostCities","setMostCities","mostSeenBandsArray","setMostSeenBandsArray","mostConcertsOfOneBand","setMostConcertsOfOneBand","yearCountEntries","Object","entries","cityCountEntries","allContentfulConcert","nodes","dates","allContentfulBand","edges","bands","useStaticQuery","useEffect","bandsArray","filter","elem","node","concert","concertCount","Date","date","length","id","slug","name","numberOfConcerts","sort","a","b","slice","apply","band","cityArray","fields","geocoderAddressFields","village","town","city","cityCounts","yearArray","item","year","flat","yearCounts","values","BarChart","_city$","toLowerCase","replace","siteTitle","site","siteMetadata","concerts","Layout","Seo","_ref2","ConcertCard","_concert$bands$0$imag","_toConsumableArray","isFestival","shift","toISOString","backgroundImage","image","file","url","festival","toLocaleDateString","month","day","club","_normalized_city"],"sourceRoot":""}